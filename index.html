 
 
    def sprider(self, title_name):
        """
       采集
       医疗保健 https://sc.chinaz.com/moban/YiLiaoBaoJian.html
       电子产品 https://sc.chinaz.com/moban/DianZiChanPin.html
       电子商务 https://sc.chinaz.com/moban/DianZiShangWu.html
       婚纱模板 https://sc.chinaz.com/moban/HunShaMoBan.html
       电脑主机 https://sc.chinaz.com/moban/DianNaoZhuJi.html
       旅游交通 https://sc.chinaz.com/moban/LvYouJiaoTong.html
       体育竞技 https://sc.chinaz.com/moban/TiYuJingJi.html
       娱乐休闲 https://sc.chinaz.com/moban/YuLeXiuXian.html
       艺术时尚 https://sc.chinaz.com/moban/YiShuShiShang.html
       建筑风光 https://sc.chinaz.com/moban/JianZhuFengGuang.html
       动植食物 https://sc.chinaz.com/moban/DongZhiShiWu.html
       人物家庭 https://sc.chinaz.com/moban/RenWuJiaTing.html
       社会教育 https://sc.chinaz.com/moban/SheHuiJiaoYu.html
       公司企业 https://sc.chinaz.com/moban/GongSiQiYe.html
       :return:
       """
        if title_name == "医疗保健":
            self.first_column_name = "moban"
            self.folder_name = "HTML医疗保健模板"
            self.second_column_name = "YiLiaoBaoJian"
        elif title_name == "公司企业":
            self.first_column_name = "moban"
            self.folder_name = "HTML公司企业模板"
            self.second_column_name = "GongSiQiYe"
        elif title_name == "社会教育":
            self.first_column_name = "moban"
            self.folder_name = "HTML社会教育模板"
            self.second_column_name = "SheHuiJiaoYu"
        elif title_name == "动植食物":
            self.first_column_name = "moban"
            self.folder_name = "HTML动植食物模板"
            self.second_column_name = "DongZhiShiWu"
        elif title_name == "人物家庭":
            self.first_column_name = "moban"
            self.folder_name = "HTML人物家庭模板"
            self.second_column_name = "RenWuJiaTing"
 
        elif title_name == "建筑风光":
            self.first_column_name = "moban"
            self.folder_name = "HTML建筑风光模板"
            self.second_column_name = "JianZhuFengGuang"
        elif title_name == "艺术时尚":
            self.first_column_name = "moban"
            self.folder_name = "HTML艺术时尚模板"
            self.second_column_name = "YiShuShiShang"
        elif title_name == "娱乐休闲":
            self.first_column_name = "moban"
            self.folder_name = "HTML娱乐休闲模板"
            self.second_column_name = "YuLeXiuXian"
        elif title_name == "体育竞技":
            self.first_column_name = "moban"
            self.folder_name = "HTML体育竞技模板"
            self.second_column_name = "TiYuJingJi"
        elif title_name == "旅游交通":
            self.first_column_name = "moban"
            self.folder_name = "HTML旅游交通模板"
            self.second_column_name = "LvYouJiaoTong"
        elif title_name == "电脑主机":
            self.first_column_name = "moban"
            self.folder_name = "HTML电脑主机模板"
            self.second_column_name = "DianNaoZhuJi"
 
        elif title_name == "电子产品":
            self.first_column_name = "moban"
            self.folder_name = "HTML电子产品模板"
            self.second_column_name = "DianZiChanPin"
 
        elif title_name == "电子商务":
            self.first_column_name = "moban"
            self.folder_name = "HTML电子商务模板"
            self.second_column_name = "DianZiShangWu"
 
        BaseFrame().right("本次采集参数：日志路径：" + str(BaseFrame().LOG_PATH) + "")
        BaseFrame().right("本次采集参数：sprider_count=" + str(self.sprider_count) + "")
        BaseFrame().right("本次采集参数：title_name=" + title_name + "")
        BaseFrame().right("本次采集参数：second_column_name=" + self.second_column_name + "")
        # self.folder_name = "JS表单验证"
        self.sprider_category = title_name  # 一级目录self.folder_name
        second_folder_name = str(self.sprider_count) + "个" + self.folder_name  # 二级目录
        self.sprider_type = second_folder_name
        self.merchant = int(self.sprider_start_count) // int(self.max_pager) + 1  # 起始页码用于效率采集
        # 原始路径+一级目录+二级目录
        self.file_path = self.save_path + os.sep + self.sprider_top_level + os.sep + self.folder_name + os.sep + second_folder_name
 
        self.save_path = self.save_path + os.sep + self.sprider_top_level + os.sep + self.folder_name + os.sep + second_folder_name + os.sep + self.folder_name
        BaseFrame().debug("开始采集ChinaZJL" + self.folder_name + "...")
        sprider_url = (self.base_url + "/{1}/{0}.html".format(self.second_column_name, self.first_column_name))
 
        down_path = "D:\\Freedom\\Sprider\\ChinaZ\\" + self.sprider_top_level + "\\" + self.folder_name + "\\" + second_folder_name + "\\Temp\\"
        if os.path.exists(down_path) is True:
            shutil.rmtree(down_path)
        if os.path.exists(down_path) is False:
            os.makedirs(down_path)
 
        if os.path.exists(self.save_path) is True:
            shutil.rmtree(self.save_path)
        if os.path.exists(self.save_path) is False:
            os.makedirs(self.save_path)
        chrome_options = webdriver.ChromeOptions()
        diy_prefs = {'profile.default_content_settings.popups': 0,
                     'download.default_directory': '{0}'.format(down_path)}
        # 添加路径到selenium配置中
        chrome_options.add_experimental_option('prefs', diy_prefs)
        chrome_options.add_argument('--headless')  # 隐藏浏览器
        # 实例化chrome浏览器时，关联忽略证书错误
        driver = webdriver.Chrome(options=chrome_options)
        driver.set_window_size(1280, 800)  # 分辨率 1280*800
        #
        BaseFrame().debug("开始采集" + sprider_url)
        driver.get(sprider_url)
        # content = driver.page_source
 
        element_list = driver.find_elements(By.CLASS_NAME, "masonry-brick")  # 列表页面 核心内容 box col3 ws_block masonry-brick
        # element_list = div_elem.find_elements(By.CLASS_NAME, 'item')
        # print(element_list.get_attribute('innerHTML'))
 
        laster_pager_div = driver.find_element(By.CLASS_NAME, "fenye")
        laster_pager_a = laster_pager_div.find_elements(By.TAG_NAME, 'a')
        laster_pager_url = laster_pager_a[len(laster_pager_a) - 2]
        page_end_number = int(laster_pager_url.text)
        self.page_count = self.merchant
        while self.page_count <= int(page_end_number):  # 翻完停止
            try:
                if self.page_count == 1:
                    self.sprider_detail(driver, element_list, self.page_count, page_end_number, down_path)
                    pass
                else:
                    if self.haved_sprider_count == self.sprider_count:
                        BaseFrame().debug("采集到达数量采集停止...")
                        BaseFrame().debug("开始写文章...")
                        self.builder_word(self.folder_name, self.word_content_list)
                        BaseFrame().debug("文件编写完毕，请到对应的磁盘查看word文件和下载文件！")
                        break
                    # (self.base_url + "/sort/{0}/{1}/".format(url_index, self.page_count))
                    # http://soft.onlinedown.net/sort/177/2/
                    # https://sc.chinaz.com//jianli/xiaochengchu_2.html
                    next_url = self.base_url + "/{2}/{0}_{1}.html".format(self.second_column_name, self.page_count,
                                                                          self.first_column_name)
 
                    driver.get(next_url)
 
                    element_list = driver.find_elements(By.CLASS_NAME, "masonry-brick")  # 列表页面 核心内容
                    self.sprider_detail(driver, element_list, self.page_count, page_end_number, down_path)
                    pass
                # print(self.page_count)
                self.page_count = self.page_count + 1  # 页码增加1
            except Exception as e:
                print("sprider()执行过程出现错误:" + str(e))
                sleep(1)

